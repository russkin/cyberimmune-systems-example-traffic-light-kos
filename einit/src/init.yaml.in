entities:

# The `ControlSystem` entity can call `LightsGPIO`.
- name: traffic_light.ControlSystem
  connections:
  - target: traffic_light.LightsGPIO
    id: lights_gpio_connection
@INIT_ControlSystem_ENTITY_CONNECTIONS+@

# The `Connector` entity can call `ControlSystem` and `CentralServer`.
- name: traffic_light.Connector
  env:
    VFS_NETWORK_BACKEND: client:kl.VfsNet
  connections:
  - target: traffic_light.ControlSystem
    id: lights_control_system_connection
  - target: kl.VfsNet
    id: kl.VfsNet 
@INIT_Connector_ENTITY_CONNECTIONS+@


# The `LightsGPIO` entity can call `Diagnostics`.
- name: traffic_light.LightsGPIO
  connections:
  - target: traffic_light.Diagnostics
    id: diagnostics_connection
@INIT_LightsGPIO_ENTITY_CONNECTIONS+@

# The `Diagnostics` entity can respond to requests and create TCP sockets.
- name: traffic_light.Diagnostics
  env:
    VFS_FILESYSTEM_BACKEND: client:kl.VfsNet
    VFS_NETWORK_BACKEND: client:kl.VfsNet
  connections:
  - target: kl.VfsNet
    id: kl.VfsNet
@INIT_Diagnostics_ENTITY_CONNECTIONS@

# Entity "client"
- name: client.Client
  env:
    VFS_FILESYSTEM_BACKEND: client:kl.VfsNet
    VFS_NETWORK_BACKEND: client:kl.VfsNet
  connections:
  - target: kl.VfsNet
    id: kl.VfsNet
@INIT_Client_ENTITY_CONNECTIONS+@

# Entity "server"
- name: server.Server
  env:
    VFS_FILESYSTEM_BACKEND: client:kl.VfsNet
    VFS_NETWORK_BACKEND: client:kl.VfsNet
  connections:
  - target: kl.VfsNet
    id: kl.VfsNet
@INIT_Server_ENTITY_CONNECTIONS+@

- name: traffic_light.KlogEntity
  path: @INIT_KlogEntity_PATH@
  connections:
  - target: traffic_light.KlogStorageEntity
    id: {var: KLOG_STORAGE_SERVER_CONNECTION_ID, include: klog_storage/client.h}

- name: traffic_light.KlogStorageEntity

@INIT_EXTERNAL_ENTITIES@